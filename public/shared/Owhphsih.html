<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>112205 - ì†ì•ˆì— ê°€ì´ë“œ</title>
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiMTEyMjA1Iiwic2hvcnRfbmFtZSI6IjExMjIwNSIsInN0YXJ0X3VybCI6Ii4iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsInRoZW1lX2NvbG9yIjoiIzQyODVGNCJ9">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            background-color: #f0f2f5;
            overflow-x: hidden;
        }
        .hidden { display: none !important; }
        
        /* ì•±ê³¼ 100% ë™ì¼í•œ CSS (ë³µì‚¬) */
        .full-screen-bg { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            object-fit: cover; 
            z-index: 1; 
        }
        .ui-layer { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: 10; 
            display: flex; 
            flex-direction: column;
        }
        .header-safe-area { 
            position: relative;
            width: 100%; 
            height: 80px; 
            flex-shrink: 0; 
            z-index: 20;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 0 1rem;
        }
        .content-safe-area { 
            flex: 1; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
            background: transparent;
            z-index: 25;
        }
        .footer-safe-area { 
            width: 100%; 
            height: 100px; 
            flex-shrink: 0; 
            z-index: 30; 
            display: flex; 
            justify-content: space-around; 
            align-items: center; 
            padding: 0 1rem;
        }
        
        /* í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ */
        .text-content {
            padding: 2rem 1.5rem;
            line-height: 1.8;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        .readable-on-image {
            color: white;
            text-shadow: 0px 2px 8px rgba(0, 0, 0, 0.95);
        }
        
        /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ (ì•±ê³¼ ë™ì¼) */
        .interactive-btn {
            transition: transform 0.1s ease;
            cursor: pointer;
            border: none;
        }
        .interactive-btn:active {
            transform: scale(0.95);
        }
        
        /* í—¤ë” (ë©”íƒ€ë°ì´í„°) */
        .header {
            padding: 20px;
            background-color: #4285F4; /* Gemini Blue - ì•± í†µì¼ */
            color: #fff;
            text-align: center;
        }
        .header h1 {
            margin: 0 0 15px 0;
            font-size: 28px;
        }
        .metadata {
            font-size: 14px;
            opacity: 0.9;
        }
        .metadata p {
            margin: 5px 0;
        }
        
        /* ê°¤ëŸ¬ë¦¬ ë·° */
        #gallery-view {
            padding: 15px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        /* ë°˜ì‘í˜•: íƒœë¸”ë¦¿/ë…¸íŠ¸ë¶/PC (768px ì´ìƒ) */
        @media (min-width: 768px) {
            .gallery-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 20px;
            }
            #gallery-view {
                padding: 30px;
            }
        }
        
        .gallery-item {
            cursor: pointer;
            text-align: center;
        }
        .gallery-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            background-color: #e9e9e9;
        }
        .gallery-item:hover img {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
        .gallery-item p {
            margin: 8px 0 0;
            font-weight: 700;
            color: #333;
            font-size: 14px;
        }
        
        /* ê°¤ëŸ¬ë¦¬ í•˜ë‹¨ ë²„íŠ¼ */
        .gallery-footer {
            text-align: center;
            padding: 30px 15px;
        }
        .app-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #4285F4;
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
            transition: all 0.3s;
        }
        .app-button:hover {
            background: #3367D6;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(66, 133, 244, 0.4);
        }
    </style>
</head>
<body>
    <!-- âŒ X ë‹«ê¸° ë²„íŠ¼ (ìš°ì¸¡ ìƒë‹¨, ìµœìƒìœ„ z-index) -->
    <button id="closeWindowBtn" onclick="window.close()" title="í˜ì´ì§€ ë‹«ê¸°" style="position: fixed; top: 1rem; right: 1rem; z-index: 10000; width: 3rem; height: 3rem; display: flex; align-items: center; justify-content: center; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px); border-radius: 50%; color: #4285F4; cursor: pointer; transition: all 0.2s ease; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); border: none;">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
        </svg>
    </button>
    
    <!-- í—¤ë” (ë©”íƒ€ë°ì´í„°) -->
    <div class="header">
        <h1>112205</h1>
        <div class="metadata">
            <p>ğŸ‘¤ ì—¬í–‰ì ë‹˜ì´ ë³´ëƒ„</p>
            <p>ğŸ“ ë¯¸ì§€ì •</p>
            <p>ğŸ“… 2025ë…„ 11ì›” 22ì¼</p>
        </div>
    </div>
    
    <!-- ê°¤ëŸ¬ë¦¬ ë·° -->
    <div id="gallery-view">
        
        <div class="gallery-grid">
            
        </div>
        <div class="gallery-footer">
            <a href="https://6e9c1b21-2f71-4aa0-88c6-6094bd29a083-00-2nko28mxcvtbi.riker.replit.dev" class="app-button" id="home-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px;">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
                ì†ì•ˆì— ê°€ì´ë“œ ì‹œì‘í•˜ê¸°
            </a>
        </div>
    </div>
    
    <!-- ìƒì„¸ ë·° (ì•±ê³¼ 100% ë™ì¼í•œ êµ¬ì¡°) -->
    <div id="detail-view" class="ui-layer hidden">
        <img id="detail-bg" src="" class="full-screen-bg">
        <header class="header-safe-area">
            <button id="detail-back" class="interactive-btn" style="width: 3rem; height: 3rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); position: absolute; top: 50%; left: 1rem; transform: translateY(-50%);" aria-label="ë’¤ë¡œê°€ê¸°">
                <svg xmlns="http://www.w3.org/2000/svg" style="width: 1.5rem; height: 1.5rem;" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                </svg>
            </button>
        </header>
        <div class="content-safe-area">
            <div id="detail-text" class="text-content hidden">
                <p id="detail-description" class="readable-on-image" style="font-size: 1.25rem; line-height: 1.75rem;"></p>
            </div>
        </div>
        <footer id="detail-footer" class="footer-safe-area hidden" style="background: transparent;">
            <button id="detail-audio" class="interactive-btn" style="width: 4rem; height: 4rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);" aria-label="ì˜¤ë””ì˜¤ ì¬ìƒ">
                <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem;" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.648c1.295.748 1.295 2.538 0 3.286L7.279 20.99c-1.25.717-2.779-.217-2.779-1.643V5.653z" clip-rule="evenodd" />
                </svg>
                <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem; display: none;" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 01.75-.75H9a.75.75 0 01.75.75v13.5a.75.75 0 01-.75.75H7.5a.75.75 0 01-.75-.75V5.25zm7.5 0A.75.75 0 0115 4.5h1.5a.75.75 0 01.75.75v13.5a.75.75 0 01-.75.75H15a.75.75 0 01-.75-.75V5.25z" clip-rule="evenodd" />
                </svg>
            </button>
            <button id="text-toggle" class="interactive-btn" style="width: 4rem; height: 4rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);" aria-label="í•´ì„¤ ì½ê¸°">
                <svg xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem;" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
            </button>
            <a href="https://6e9c1b21-2f71-4aa0-88c6-6094bd29a083-00-2nko28mxcvtbi.riker.replit.dev" id="detail-home" class="interactive-btn" style="width: 4rem; height: 4rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); text-decoration: none;" aria-label="ì•±ìœ¼ë¡œ ì´ë™">
                <svg xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem;" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
            </a>
        </footer>
    </div>
    
    <!-- ë°ì´í„° ì €ì¥ -->
    <script id="app-data" type="application/json">[]</script>
    
    <script>
        // ë°ì´í„° ë¡œë“œ
        const appData = JSON.parse(document.getElementById('app-data').textContent);
        const galleryView = document.getElementById('gallery-view');
        const detailView = document.getElementById('detail-view');
        const header = document.querySelector('.header');
        
        // Web Speech API
        const synth = window.speechSynthesis;
        let voices = [];
        let currentUtterance = null;
        
        function populateVoiceList() {
            voices = synth.getVoices().filter(v => v.lang.startsWith('ko'));
        }
        
        function stopAudio() {
            if (synth.speaking) {
                synth.pause();
                synth.cancel();
            }
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');
            if (playIcon) playIcon.style.display = 'block';
            if (pauseIcon) pauseIcon.style.display = 'none';
        }
        
        function playAudio(text) {
            stopAudio();
            
            // âš ï¸ **í•µì‹¬ ë¡œì§ - ì ˆëŒ€ ìˆ˜ì • ê¸ˆì§€!** (2025-10-03 ì¹˜ëª…ì  ë²„ê·¸ í•´ê²°)
            // 
            // ë¬¸ì œ: HTML ë‚´ë¶€ JavaScriptì—ì„œ ì •ê·œì‹ /<brs*/?>/gi ì‚¬ìš© ì‹œ
            //       HTML íŒŒì„œê°€ < > ë¥¼ &lt; &gt; ë¡œ ë³€í™˜í•˜ì—¬ JavaScript íŒŒì‹± ì—ëŸ¬ ë°œìƒ
            //       â†’ "Uncaught SyntaxError: Unexpected token '&'" 
            //
            // í•´ê²°: new RegExp() ë°©ì‹ìœ¼ë¡œ HTML íŒŒì„œì™€ 100% ë¶„ë¦¬
            //       - ì•ˆì „ì„±: HTML escape ë¬¸ì œ ì›ì²œ ì°¨ë‹¨
            //       - í˜¸í™˜ì„±: ëª¨ë“  ë¸Œë¼ìš°ì € ì§€ì›
            //       - ì˜êµ¬ì„±: ì•ìœ¼ë¡œ ì ˆëŒ€ ê¹¨ì§€ì§€ ì•ŠìŒ
            //
            // ì˜í–¥: 27ê°œ ê¸°ì¡´ ê³µìœ  í˜ì´ì§€ DB ì¼ê´„ ì—…ë°ì´íŠ¸ ì™„ë£Œ (2025-10-03)
            const cleanText = text.replace(new RegExp('<br\s*/?>', 'gi'), ' ');
            
            // ë¬¸ì¥ ë¶„ë¦¬ ë° í•˜ì´ë¼ì´íŠ¸ ì¤€ë¹„
            const sentences = cleanText.match(/[^.!?]+[.!?]+/g) || [cleanText];
            const textElement = document.getElementById('detail-description');
            
            // ì›ë³¸ í…ìŠ¤íŠ¸ ì €ì¥
            const originalText = cleanText;
            
            currentUtterance = new SpeechSynthesisUtterance(cleanText);
            
            // âš ï¸ ì˜¤í”„ë¼ì¸ ìµœì í™” - Microsoft Heami ìŒì„± ê°•ì œ ì§€ì • (í˜„ì¥ í…ŒìŠ¤íŠ¸ ì™„ë£Œ)
            // ì²¨ë¶€ëœ HTML ë°©ì‹: ì •í™•í•œ ì´ë¦„ ë§¤ì¹­ìœ¼ë¡œ ìŒì„± ê³ ì •
            const targetVoice = voices.find(v => v.name === 'Microsoft Heami - Korean (Korea)');
            currentUtterance.voice = targetVoice;
            currentUtterance.lang = 'ko-KR';
            currentUtterance.rate = 1.0;
            
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');
            
            let currentSentenceIndex = 0;
            
            currentUtterance.onstart = () => {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            };
            
            // ë‹¨ì–´ ê²½ê³„ë§ˆë‹¤ í•˜ì´ë¼ì´íŠ¸
            currentUtterance.onboundary = (event) => {
                if (event.name === 'sentence') {
                    // í˜„ì¬ ë¬¸ì¥ í•˜ì´ë¼ì´íŠ¸
                    const highlightedHTML = sentences.map((sentence, idx) => {
                        if (idx === currentSentenceIndex) {
                            return '<span style="background-color: rgba(66, 133, 244, 0.3); font-weight: 600;">' + sentence + '</span>';
                        }
                        return sentence;
                    }).join('');
                    
                    textElement.innerHTML = highlightedHTML;
                    currentSentenceIndex++;
                }
            };
            
            currentUtterance.onend = () => {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
                // í•˜ì´ë¼ì´íŠ¸ ì œê±°, ì›ë³¸ ë³µì›
                textElement.textContent = originalText;
            };
            
            synth.speak(currentUtterance);
        }
        
        populateVoiceList();
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = populateVoiceList;
        }
        
        // ê°¤ëŸ¬ë¦¬ ì•„ì´í…œ í´ë¦­ (ì•±ê³¼ 100% ë™ì¼í•œ ë¡œì§)
        document.querySelectorAll('.gallery-item').forEach(item => {
            item.addEventListener('click', () => {
                const itemData = appData[parseInt(item.dataset.id)];
                
                // ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì •
                document.getElementById('detail-bg').src = itemData.imageDataUrl;
                
                // í…ìŠ¤íŠ¸ ì„¤ì •
                document.getElementById('detail-description').textContent = itemData.description;
                
                // UI í‘œì‹œ
                galleryView.classList.add('hidden');
                header.classList.add('hidden');
                detailView.classList.remove('hidden');
                document.getElementById('detail-footer').classList.remove('hidden');
                
                // í…ìŠ¤íŠ¸ëŠ” í‘œì‹œ ìƒíƒœë¡œ ì‹œì‘ (ìŒì„±ê³¼ ë™ì‹œì— ë³´ì„)
                document.getElementById('detail-text').classList.remove('hidden');
                
                // ìŒì„± ìë™ ì¬ìƒ
                playAudio(itemData.description);
            });
        });
        
        // ğŸ”™ ë³´ê´€í•¨ìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ (ê°¤ëŸ¬ë¦¬ ë·°)
        const galleryBackBtn = document.getElementById('gallery-back-btn');
        if (galleryBackBtn) {
            galleryBackBtn.addEventListener('click', () => {
                window.location.href = '/#archive';
            });
        }
        
        // ë’¤ë¡œ ê°€ê¸°
        document.getElementById('detail-back').addEventListener('click', () => {
            stopAudio();
            detailView.classList.add('hidden');
            document.getElementById('detail-text').classList.add('hidden');
            document.getElementById('detail-footer').classList.add('hidden');
            header.classList.remove('hidden');
            galleryView.classList.remove('hidden');
        });
        
        // í…ìŠ¤íŠ¸ í† ê¸€ ë²„íŠ¼ (ì•±ê³¼ ë™ì¼í•œ ë¡œì§)
        document.getElementById('text-toggle')?.addEventListener('click', () => {
            document.getElementById('detail-text').classList.toggle('hidden');
        });
        
        // ìŒì„± ì¬ìƒ/ì •ì§€
        document.getElementById('detail-audio').addEventListener('click', () => {
            if (synth.speaking) {
                stopAudio();
            } else {
                const text = document.getElementById('detail-description').textContent;
                playAudio(text);
            }
        });
        
        // í™ˆ ë²„íŠ¼ (ê°¤ëŸ¬ë¦¬ í•˜ë‹¨)
        const homeButton = document.getElementById('home-button');
        if (homeButton) {
            homeButton.addEventListener('click', (e) => {
                e.preventDefault();
                stopAudio();
                setTimeout(() => {
                    window.location.href = homeButton.href;
                }, 200);
            });
        }
        
        // í™ˆ ë²„íŠ¼ (ìƒì„¸ ë·° í•˜ë‹¨) - ìŒì„± ë“£ë‹¤ê°€ ë°”ë¡œ ì•±ìœ¼ë¡œ ê°€ê¸°
        const detailHome = document.getElementById('detail-home');
        if (detailHome) {
            detailHome.addEventListener('click', (e) => {
                e.preventDefault();
                stopAudio();
                setTimeout(() => {
                    window.location.href = detailHome.href;
                }, 200);
            });
        }
        
        // í˜ì´ì§€ ì´íƒˆ ì‹œ ì˜¤ë””ì˜¤ ì •ì§€ (ë°±ê·¸ë¼ìš´ë“œ ì¬ìƒ ë°©ì§€)
        window.addEventListener('beforeunload', () => {
            stopAudio();
        });
    </script>
    
    <!-- âš ï¸ í•µì‹¬ ë¡œì§: Service Worker ë“±ë¡ (ì˜¤í”„ë¼ì¸ ì§€ì›) -->
    <script>
        // Service Worker ì§€ì› í™•ì¸ ë° ë“±ë¡
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw-share.js')
                    .then(registration => {
                        console.log('âœ… [SW] ë“±ë¡ ì„±ê³µ:', registration.scope);
                    })
                    .catch(error => {
                        console.log('âŒ [SW] ë“±ë¡ ì‹¤íŒ¨:', error);
                    });
            });
        }
    </script>
</body>
</html>