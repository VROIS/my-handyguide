<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <!-- ğŸ¤ğŸ”’ 2025.12.04: TTS ê°•ì œ ì°¨ë‹¨ + ë²ˆì—­ ì™„ë£Œ í›„ ì¬ìƒ (speechSynthesis.speak ê°€ë¡œì±„ê¸°) -->
    <script>
        (function() {
            'use strict';
            
            // ì–¸ì–´ì½”ë“œ ë§¤í•‘
            var LANG_MAP = {
                'ko': 'ko-KR', 'en': 'en-US', 'ja': 'ja-JP',
                'zh-CN': 'zh-CN', 'fr': 'fr-FR', 'de': 'de-DE', 'es': 'es-ES'
            };
            
            // ğŸŒ 2025.12.05: URL íŒŒë¼ë¯¸í„° + localStorage ëª¨ë‘ ì²´í¬
            var params = new URLSearchParams(window.location.search);
            var urlLang = params.get('lang');
            var storedLang = null;
            try { storedLang = localStorage.getItem('appLanguage'); } catch(e) {}
            
            // URL íŒŒë¼ë¯¸í„° ìš°ì„ , ì—†ìœ¼ë©´ localStorage
            var activeLang = urlLang || storedLang || 'ko';
            var targetLang = LANG_MAP[activeLang] || LANG_MAP[activeLang.split('-')[0]] || null;
            
            // í•œêµ­ì–´ê°€ ì•„ë‹ˆë©´ â†’ ë²ˆì—­ í•„ìš”, TTS ëŒ€ê¸°
            var needsTranslation = activeLang !== 'ko' && targetLang;
            window.__translationComplete = !needsTranslation;
            window.__ttsTargetLang = targetLang;
            window.__ttsQueue = [];
            
            if (needsTranslation) {
                console.log('ğŸ¤ğŸ”’ [TTS ì°¨ë‹¨] ë²ˆì—­ ëŒ€ê¸° ì¤‘... ëŒ€ìƒ:', targetLang);
            }
            
            // ğŸ”’ speechSynthesis.speak ì›ë³¸ ë°±ì—… ë° ê°€ë¡œì±„ê¸°
            var originalSpeak = window.speechSynthesis.speak.bind(window.speechSynthesis);
            
            window.speechSynthesis.speak = function(utterance) {
                if (!window.__translationComplete) {
                    console.log('ğŸ¤ğŸ”’ [TTS ì°¨ë‹¨] ëŒ€ê¸°ì—´ ì¶”ê°€ (ë²ˆì—­ ë¯¸ì™„ë£Œ)');
                    window.__ttsQueue.push(utterance);
                    return;
                }
                
                if (window.__ttsTargetLang) {
                    var descEl = document.getElementById('detail-description');
                    if (descEl) {
                        // ğŸŒ Google Translateì˜ <font> íƒœê·¸ì—ì„œ ë²ˆì—­ëœ í…ìŠ¤íŠ¸ ì¶”ì¶œ
                        var fontEl = descEl.querySelector('font');
                        var translatedText = fontEl ? (fontEl.innerText || fontEl.textContent) : (descEl.innerText || descEl.textContent);
                        utterance.text = translatedText;
                        utterance.lang = window.__ttsTargetLang;
                        console.log('ğŸ¤âœ… [TTS ì¬ìƒ] ì–¸ì–´:', window.__ttsTargetLang, fontEl ? '(fontíƒœê·¸)' : '(innerText)', 'ê¸¸ì´:', translatedText.length);
                    }
                }
                
                originalSpeak(utterance);
            };
            
            // ë²ˆì—­ ì™„ë£Œ ê°ì§€
            function watchForTranslation() {
                if (!needsTranslation) return;
                
                var observer = new MutationObserver(function() {
                    var hasTranslateClass = document.body.classList.contains('translated-ltr') || 
                                            document.body.classList.contains('translated-rtl');
                    
                    if (hasTranslateClass) {
                        console.log('ğŸ¤âœ… [ë²ˆì—­ ì™„ë£Œ] TTS ì°¨ë‹¨ í•´ì œ!');
                        window.__translationComplete = true;
                        observer.disconnect();
                        
                        if (window.__ttsQueue.length > 0) {
                            console.log('ğŸ¤âœ… [ëŒ€ê¸°ì—´ ì¬ìƒ]', window.__ttsQueue.length + 'ê°œ');
                            // ğŸŒ 2025-12-24: ë²ˆì—­ í´ë˜ìŠ¤ ê°ì§€ í›„ ì‹¤ì œ í…ìŠ¤íŠ¸ ë³€í™˜ê¹Œì§€ 500ms ì¶”ê°€ ëŒ€ê¸°
                            setTimeout(function() {
                                console.log('[TTS] ë²ˆì—­ í…ìŠ¤íŠ¸ ì ìš© ëŒ€ê¸° ì™„ë£Œ (500ms)');
                                window.__ttsQueue.forEach(function(utt) {
                                    var descEl = document.getElementById('detail-description');
                                    if (descEl) {
                                        // ğŸŒ Google Translateì˜ <font> íƒœê·¸ì—ì„œ ë²ˆì—­ëœ í…ìŠ¤íŠ¸ ì¶”ì¶œ
                                        var fontEl = descEl.querySelector('font');
                                        utt.text = fontEl ? (fontEl.innerText || fontEl.textContent) : (descEl.innerText || descEl.textContent);
                                        utt.lang = window.__ttsTargetLang;
                                    }
                                    originalSpeak(utt);
                                });
                                window.__ttsQueue = [];
                            }, 500);
                        }
                    }
                });
                
                observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
                
                setTimeout(function() {
                    if (!window.__translationComplete) {
                        console.log('ğŸ¤âš ï¸ [ë²ˆì—­ íƒ€ì„ì•„ì›ƒ] ì›ë³¸ìœ¼ë¡œ ì¬ìƒ');
                        window.__translationComplete = true;
                        observer.disconnect();
                        window.__ttsQueue.forEach(function(utt) { originalSpeak(utt); });
                        window.__ttsQueue = [];
                    }
                }, 5000);
            }
            
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', watchForTranslation);
            } else {
                watchForTranslation();
            }
        })();
    </script>
    <!-- ğŸŒ 2025.12.03: ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¡œ êµ¬ê¸€ ë²ˆì—­ ì¿ í‚¤ ì„¤ì • (ìë™ ë²ˆì—­ìš©) -->
    <script>
        (function() {
            var storedLang = null;
            try { storedLang = localStorage.getItem('appLanguage'); } catch(e) {}
            var urlParams = new URLSearchParams(window.location.search);
            var urlLang = urlParams.get('lang');
            var lang = storedLang || urlLang || 'ko';
            if (lang && lang !== 'ko' && /^[a-z]{2}(-[A-Z]{2})?$/.test(lang)) {
                var domain = window.location.hostname;
                document.cookie = 'googtrans=/ko/' + lang + ';path=/;domain=' + domain;
                document.cookie = 'googtrans=/ko/' + lang + ';path=/';
                console.log('ğŸŒ [Gallery] googtrans ì¿ í‚¤ ì„¤ì • (appLanguage ìš°ì„ ):', lang);
            }
        })();
    </script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ë ìŠ¤2 - ì†ì•ˆì— ê°€ì´ë“œ</title>
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi66Cd7IqkMiIsInNob3J0X25hbWUiOiLroJ3siqQyIiwic3RhcnRfdXJsIjoiLiIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwidGhlbWVfY29sb3IiOiIjNDI4NUY0In0=">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            background-color: #f0f2f5;
            overflow-x: hidden;
        }
        .hidden { display: none !important; }
        
        /* ì•±ê³¼ 100% ë™ì¼í•œ CSS (ë³µì‚¬) */
        .full-screen-bg { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            object-fit: cover; 
            z-index: 1; 
        }
        .ui-layer { 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100%; 
            height: 100%; 
            z-index: 10; 
            display: flex; 
            flex-direction: column;
        }
        .header-safe-area { 
            position: relative;
            width: 100%; 
            height: 80px; 
            flex-shrink: 0; 
            z-index: 20;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            padding: 0 1rem;
        }
        .content-safe-area { 
            flex: 1; 
            overflow-y: auto; 
            -webkit-overflow-scrolling: touch; 
            background: transparent;
            z-index: 25;
        }
        .footer-safe-area { 
            width: 100%; 
            height: 100px; 
            flex-shrink: 0; 
            z-index: 30; 
            display: flex; 
            justify-content: space-around; 
            align-items: center; 
            padding: 0 1rem;
        }
        
        /* í…ìŠ¤íŠ¸ ì˜¤ë²„ë ˆì´ */
        .text-content {
            padding: 2rem 1.5rem;
            line-height: 1.8;
            word-break: keep-all;
            overflow-wrap: break-word;
        }
        .readable-on-image {
            color: white;
            text-shadow: 0px 2px 8px rgba(0, 0, 0, 0.95);
        }
        
        /* ë²„íŠ¼ ê³µí†µ ìŠ¤íƒ€ì¼ (ì•±ê³¼ ë™ì¼) */
        .interactive-btn {
            transition: transform 0.1s ease;
            cursor: pointer;
            border: none;
        }
        .interactive-btn:active {
            transform: scale(0.95);
        }
        
        /* í—¤ë” (ë©”íƒ€ë°ì´í„°) */
        .header {
            padding: 20px;
            background-color: #4285F4; /* Gemini Blue - ì•± í†µì¼ */
            color: #fff;
            text-align: center;
        }
        .header h1 {
            margin: 0 0 15px 0;
            font-size: 28px;
        }
        .metadata {
            font-size: 14px;
            opacity: 0.9;
        }
        .metadata p {
            margin: 5px 0;
        }
        
        /* ê°¤ëŸ¬ë¦¬ ë·° */
        #gallery-view {
            padding: 15px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        /* ë°˜ì‘í˜•: íƒœë¸”ë¦¿/ë…¸íŠ¸ë¶/PC (768px ì´ìƒ) */
        @media (min-width: 768px) {
            .gallery-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 20px;
            }
            #gallery-view {
                padding: 30px;
            }
        }
        
        .gallery-item {
            cursor: pointer;
            text-align: center;
        }
        .gallery-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            background-color: #e9e9e9;
        }
        .gallery-item:hover img {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
        .gallery-item p {
            margin: 8px 0 0;
            font-weight: 700;
            color: #333;
            font-size: 14px;
        }
        
        /* ğŸ¤ ìŒì„± ê°€ì´ë“œ ì¸ë„¤ì¼ (ë³´ê´€í•¨ í˜•ì‹) */
        .voice-thumbnail {
            width: 100%;
            height: 150px;
            background: #000;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .gallery-item:hover .voice-thumbnail {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0,0,0,0.2);
        }
        .voice-bg-logo {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0.1;
        }
        .voice-content {
            position: relative;
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px;
            text-align: center;
        }
        .voice-icon {
            width: 32px;
            height: 32px;
            color: #4285F4;
            margin-bottom: 8px;
        }
        .voice-keyword {
            color: white;
            font-size: 12px;
            line-height: 1.3;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        /* ê°¤ëŸ¬ë¦¬ í•˜ë‹¨ ë²„íŠ¼ */
        .gallery-footer {
            text-align: center;
            padding: 30px 15px;
        }
        .app-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #4285F4;
            color: white;
            padding: 16px 32px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 4px 12px rgba(66, 133, 244, 0.3);
            transition: all 0.3s;
        }
        .app-button:hover {
            background: #3367D6;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(66, 133, 244, 0.4);
        }
    </style>
</head>
<body>
    <!-- í—¤ë” (ë©”íƒ€ë°ì´í„°) -->
    <div class="header">
        <h1>ë ìŠ¤2</h1>
        <div class="metadata">
            <p>ğŸ‘¤ temp@example.com ë‹˜ì´ ë³´ëƒ„</p>
            <p>ğŸ“ Platine HÃ´tel</p>
            <p>ğŸ“… 2025-11-23</p>
        </div>
    </div>
    
    <!-- ê°¤ëŸ¬ë¦¬ ë·° -->
    <div id="gallery-view">
        
        <!-- ğŸ”™ ì¼ë°˜ ê³µìœ í˜ì´ì§€ ë¦¬í„´ ë²„íŠ¼ (ìš°ì¸¡ ìƒë‹¨ ê³ ì •, ì°½ ë‹«ê¸°) -->
        <button onclick="window.close()" style="position: fixed; top: 1rem; right: 1rem; z-index: 10000; width: 3rem; height: 3rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(8px); color: #4285F4; border: none; cursor: pointer; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3); transition: all 0.2s ease;" aria-label="ì°½ ë‹«ê¸°">
            <svg xmlns="http://www.w3.org/2000/svg" style="width: 1.5rem; height: 1.5rem;" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
            </svg>
        </button>
        
        <div class="gallery-grid">
            
            <div class="gallery-item" data-id="0" data-guid="5229cf31-1519-4911-a0fc-dab381d78f22">
                <img src="/uploads/1763783110227-39twg.jpg" alt="ê°€ì´ë“œ 1" loading="lazy">
                <p>ê°€ì´ë“œ 1</p>
            </div>
            <div class="gallery-item" data-id="1" data-guid="a150ae97-6c93-407c-bbd3-1e1742ec6d40">
                <img src="/uploads/1763783160160-kz2aa.jpg" alt="ê°€ì´ë“œ 2" loading="lazy">
                <p>ê°€ì´ë“œ 2</p>
            </div>
        </div>
        <div class="gallery-footer">
            <a href="https://My-handyguide1.replit.app" class="app-button" id="home-button">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2" style="width: 24px; height: 24px;">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
                ë‚˜ë„ ë§Œë“¤ì–´ë³´ê¸° âœ¨
            </a>
        </div>
    </div>
    
    <!-- ìƒì„¸ ë·° (ì•±ê³¼ 100% ë™ì¼í•œ êµ¬ì¡°) -->
    <div id="detail-view" class="ui-layer hidden">
        <img id="detail-bg" src="" class="full-screen-bg">
        <header class="header-safe-area">
            <button id="detail-back" class="interactive-btn" style="width: 3rem; height: 3rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 4px 12px rgba(0,0,0,0.3); position: fixed; top: 1rem; right: 1rem; z-index: 10000;" aria-label="ë’¤ë¡œê°€ê¸°">
                <svg xmlns="http://www.w3.org/2000/svg" style="width: 1.5rem; height: 1.5rem;" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18" />
                </svg>
            </button>
        </header>
        <div class="content-safe-area">
            <div id="detail-text" class="text-content hidden">
                <!-- ğŸ“ ìœ„ì¹˜ì •ë³´ì°½ (ì´ë¯¸ì§€ ëª¨ë“œ) -->
                <div id="detail-location-info" class="hidden" style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(8px); border-radius: 0.5rem; padding: 0.75rem 1rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);">
                    <svg xmlns="http://www.w3.org/2000/svg" style="width: 1.25rem; height: 1.25rem; color: #4285F4; flex-shrink: 0;" viewBox="0 0 24 24" fill="currentColor">
                        <path fill-rule="evenodd" d="M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.975 16.975 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd" />
                    </svg>
                    <span id="detail-location-name" style="font-size: 1rem; font-weight: 600; color: #1f2937;"></span>
                </div>
                <!-- ğŸ¤ ìŒì„±í‚¤ì›Œë“œì°½ (ìŒì„± ëª¨ë“œ) -->
                <div id="detail-voice-query-info" class="hidden" style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(8px); border-radius: 0.5rem; padding: 0.75rem 1rem; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);">
                    <svg xmlns="http://www.w3.org/2000/svg" style="width: 1.25rem; height: 1.25rem; color: #4285F4; flex-shrink: 0;" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8.25 4.5a3.75 3.75 0 117.5 0v8.25a3.75 3.75 0 11-7.5 0V4.5z" />
                        <path d="M6 10.5a.75.75 0 01.75.75v1.5a5.25 5.25 0 1010.5 0v-1.5a.75.75 0 011.5 0v1.5a6.751 6.751 0 01-6 6.709v2.291h3a.75.75 0 010 1.5h-7.5a.75.75 0 010-1.5h3v-2.291a6.751 6.751 0 01-6-6.709v-1.5A.75.75 0 016 10.5z" />
                    </svg>
                    <span id="detail-voice-query-text" style="font-size: 1rem; font-weight: 600; color: #1f2937; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 200px;"></span>
                </div>
                <p id="detail-description" class="readable-on-image" style="font-size: 1.25rem; line-height: 1.75rem;"></p>
            </div>
        </div>
        <footer id="detail-footer" class="footer-safe-area hidden" style="background: transparent;">
            <button id="detail-audio" class="interactive-btn" style="width: 4rem; height: 4rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);" aria-label="ì˜¤ë””ì˜¤ ì¬ìƒ">
                <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem;" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M4.5 5.653c0-1.426 1.529-2.33 2.779-1.643l11.54 6.648c1.295.748 1.295 2.538 0 3.286L7.279 20.99c-1.25.717-2.779-.217-2.779-1.643V5.653z" clip-rule="evenodd" />
                </svg>
                <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem; display: none;" viewBox="0 0 24 24" fill="currentColor">
                    <path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 01.75-.75H9a.75.75 0 01.75.75v13.5a.75.75 0 01-.75.75H7.5a.75.75 0 01-.75-.75V5.25zm7.5 0A.75.75 0 0115 4.5h1.5a.75.75 0 01.75.75v13.5a.75.75 0 01-.75.75H15a.75.75 0 01-.75-.75V5.25z" clip-rule="evenodd" />
                </svg>
            </button>
            <button id="text-toggle" class="interactive-btn" style="width: 4rem; height: 4rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);" aria-label="í•´ì„¤ ì½ê¸°">
                <svg xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem;" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                </svg>
            </button>
            <a href="https://My-handyguide1.replit.app" id="detail-home" class="interactive-btn" style="width: 4rem; height: 4rem; display: flex; align-items: center; justify-content: center; border-radius: 9999px; background: rgba(0,0,0,0.6); backdrop-filter: blur(12px); color: #4285F4; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); text-decoration: none;" aria-label="ì•±ìœ¼ë¡œ ì´ë™">
                <svg xmlns="http://www.w3.org/2000/svg" style="width: 2rem; height: 2rem;" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                </svg>
            </a>
        </footer>
    </div>
    
    <!-- ë°ì´í„° ì €ì¥ -->
    <script id="app-data" type="application/json">[{"id":0,"guid":"5229cf31-1519-4911-a0fc-dab381d78f22","title":"ì œëª© ì—†ìŒ","imageDataUrl":"/uploads/1763783110227-39twg.jpg","description":"ì, ì—¬ê¸° ì—¬ëŸ¬ë¶„, ì§€ê¸ˆ ì´ ì²œì‚¬, ê·¸ëƒ¥ ì›ƒê³  ìˆëŠ” ê²Œ ì•„ë‹™ë‹ˆë‹¤! ì¤‘ì„¸ ì‹œëŒ€ ì¢…êµ ë¯¸ìˆ ì—ì„œ ì´ë ‡ê²Œ í™˜í•œ ë¯¸ì†Œë¥¼ ì§“ëŠ” ì²œì‚¬ëŠ” ê±°ì˜ ì°¾ì•„ë³¼ ìˆ˜ ì—†ë‹¤ëŠ” ì‚¬ì‹¤, ì•Œê³  ê³„ì…¨ë‚˜ìš”? \n\nì´ ì¡°ê°ìƒì´ ë§Œë“¤ì–´ì§„ ì‹œê¸°ëŠ” ëŒ€ëµ 1230ë…„, ê³ ë ¤ì‹œëŒ€ ë¬´ì‹ ì •ê¶Œì´ ì ˆì •ì— ë‹¬í–ˆì„ ë•Œ, ì„œì–‘ì—ì„œëŠ” ê³ ë”• ê±´ì¶•ì˜ í™©ê¸ˆê¸°ê°€ í•œì°½ì´ì—ˆìŠµë‹ˆë‹¤. ë°”ë¡œ í”„ë‘ìŠ¤ ë­ìŠ¤ ëŒ€ì„±ë‹¹ì— ìˆëŠ” 'ë¯¸ì†Œ ì§“ëŠ” ì²œì‚¬' ì¡°ê°ìƒì´ì£ . ì´ ì¡°ê°ìƒì€ ì‘ì ë¯¸ìƒì´ì§€ë§Œ, ê·¸ ë‹¹ì‹œ ìˆ˜ë§ì€ ì¥ì¸ë“¤ì´ ëŒ€ì„±ë‹¹ ê±´ì¶•ì— ì°¸ì—¬í•˜ë©° ì´ëŸ° ê±¸ì‘ë“¤ì„ ë‚¨ê²¼ìŠµë‹ˆë‹¤. \n\nì´ ì²œì‚¬ëŠ” ë­ìŠ¤ ëŒ€ì„±ë‹¹ ì„œìª½ íŒŒì‚¬ë“œ ë¶ìª½ í¬íƒˆ, ì¦‰ ì„±ëª¨ ë§ˆë¦¬ì•„ì˜ ìƒì• ë¥¼ ë¬˜ì‚¬í•œ íŒ€íŒŒëˆ” ì•„ë˜ ë¬¸ì„¤ì£¼ì— ìˆëŠ” ì¡°ê°ìƒ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. ê³ ë”• ì‹œëŒ€ ì´ˆê¸° ì¡°ê°ìƒë“¤ì´ ì—„ìˆ™í•˜ê³  ë”±ë”±í•œ í‘œì •ì„ ì§“ë˜ ê²ƒê³¼ëŠ” ë‹¬ë¦¬, ì´ ì²œì‚¬ëŠ” ì–¼êµ´ ê°€ë“í•œ í™˜í•œ ë¯¸ì†Œ, ì‚´ì§ ì™¼ìª½ìœ¼ë¡œ ê¸°ìš¸ì–´ì§„ ê³ ê°œ, ê·¸ë¦¬ê³  ì‚´ì•„ìˆëŠ” ë“¯í•œ ì˜· ì£¼ë¦„ í‘œí˜„ìœ¼ë¡œ ìƒë™ê°ê³¼ ì¸ê°„ë¯¸ë¥¼ ë¶ˆì–´ë„£ì—ˆìŠµë‹ˆë‹¤. \n\nê°€ë§Œíˆ ë³´ë©´, ì´ ì²œì‚¬ì˜ ë¯¸ì†ŒëŠ” ì…ê¼¬ë¦¬ë§Œ ì‚´ì§ ì˜¬ë¼ê°„ ê²ƒì´ ì•„ë‹ˆë¼, ëˆˆê°€ì—ë„ ë¯¸ì†Œê°€ ë²ˆì ¸ìˆì–´ì„œ ë³´ëŠ” ì‚¬ëŒë§ˆì € ê¸°ë¶„ ì¢‹ê²Œ ë§Œë“­ë‹ˆë‹¤. íŠ¹íˆ, ì¡°ê°ìƒì˜ ë¯¸ì†ŒëŠ” ì¢…êµì  ì—„ìˆ™í•¨ì„ ë„˜ì–´, ì„¸ì†ì ì¸ ì•„ë¦„ë‹¤ì›€ì„ ì¶”êµ¬í•˜ê¸° ì‹œì‘í•œ ê³ ë”• ì˜ˆìˆ ì˜ ì¤‘ìš”í•œ ì „í™˜ì ì„ ë³´ì—¬ì£¼ëŠ” ìƒì§•ê³¼ë„ ê°™ìŠµë‹ˆë‹¤. ì§€ê¸ˆ ë´ë„ ì €ì ˆë¡œ ë¯¸ì†Œê°€ ì§€ì–´ì§€ì§€ ì•Šë‚˜ìš”? ë­ìŠ¤ ëŒ€ì„±ë‹¹ì— ì§ì ‘ ê°€ì„œ ì´ ì²œì‚¬ì˜ ë¯¸ì†Œë¥¼ ë§ˆì£¼í•œë‹¤ë©´, ì—¬ëŸ¬ë¶„ì˜ ì—¬í–‰ë„ ë¶„ëª…íˆ ë” ë¹›ë‚  ê²ë‹ˆë‹¤!","voiceLang":"ko-KR","locationName":"Platine HÃ´tel","voiceQuery":"ì œëª© ì—†ìŒ","voiceName":null},{"id":1,"guid":"a150ae97-6c93-407c-bbd3-1e1742ec6d40","title":"ì œëª© ì—†ìŒ","imageDataUrl":"/uploads/1763783160160-kz2aa.jpg","description":"ë†€ë¼ì§€ ë§ˆì„¸ìš”! ì´ ì›…ì¥í•œ ì„±ë‹¹ì´ ì„¸ê³„ 1, 2ì°¨ ëŒ€ì „ ë•Œ í­ê²©ì„ ë‹¹í•´ ì‹¬ê°í•˜ê²Œ í›¼ì†ë˜ì—ˆë‹¤ëŠ” ì‚¬ì‹¤! í”„ë‘ìŠ¤ì¸ë“¤ì˜ ëˆì§ˆê¸´ ë³µì› ë…¸ë ¥ ëì— ì§€ê¸ˆì˜ ëª¨ìŠµì„ ë˜ì°¾ì•˜ë‹¤ê³  í•©ë‹ˆë‹¤.\n\nì§€ê¸ˆ ë³´ì‹œëŠ” ì´ê³³ì€ í”„ë‘ìŠ¤ ë­ìŠ¤(Reims)ì— ìœ„ì¹˜í•œ ë­ìŠ¤ ëŒ€ì„±ë‹¹, ë…¸íŠ¸ë¥´ë‹´ ëŒ€ì„±ë‹¹ì…ë‹ˆë‹¤. 13ì„¸ê¸°, ìš°ë¦¬ë‚˜ë¼ë¡œ ì¹˜ë©´ ê³ ë ¤ì‹œëŒ€ ìµœì¶©í—Œ ë¬´ì‹ ì •ê¶Œì´ ëë‚  ë¬´ë µ ì§€ì–´ì§€ê¸° ì‹œì‘í–ˆìœ¼ë‹ˆ, ì•½ 800ë…„ì˜ ì—­ì‚¬ë¥¼ ìë‘í•˜ëŠ” ê³³ì´ì£ . í”„ë‘ìŠ¤ ê³ ë”• ê±´ì¶•ì˜ ì •ìˆ˜ì´ì ìƒì§•ì ì¸ ì¥ì†Œë¡œ, í”„ë‘ìŠ¤ ì—­ì‚¬ì—ì„œ ë§¤ìš° ì¤‘ìš”í•œ ì˜ë¯¸ë¥¼ ì§€ë‹™ë‹ˆë‹¤.\n\nì´ê³³ì€ ë¬´ë ¤ 25ëª…ì˜ í”„ë‘ìŠ¤ ì™•ì´ ëŒ€ê´€ì‹ì„ ì˜¬ë¦° ì—­ì‚¬ì˜ í˜„ì¥ì´ê¸°ë„ í•©ë‹ˆë‹¤. ëŒ€ì„±ë‹¹ì— ë“¤ì–´ì„œëŠ” ìˆœê°„, ìˆ˜ë§ì€ ì™•ë“¤ì´ ë°Ÿì•˜ë˜ ê·¸ ë•… ìœ„ì— ì„œ ìˆë‹¤ëŠ” ê²½ì™¸ê°ì„ ëŠë‚„ ìˆ˜ ìˆì„ ê±°ì˜ˆìš”. íŠ¹íˆ ì”ë‹¤ë¥´í¬ê°€ ì˜êµ­êµ°ì„ ë¬¼ë¦¬ì¹˜ê³  ìƒ¤ë¥¼ 7ì„¸ì˜ ëŒ€ê´€ì‹ì„ ì£¼ê´€í–ˆë˜ ê³³ìœ¼ë¡œë„ ìœ ëª…í•˜ì£ . ì„±ë‹¹ ì™¸ë¶€ë¥¼ ìì„¸íˆ ë³´ë©´ ìˆ˜ë§ì€ ì¡°ê°ìƒê³¼ ì •êµí•œ ë¶€ì¡°ë“¤ì´ ë³´ì´ì‹œë‚˜ìš”? ì¤‘ì„¸ ì‹œëŒ€ ì¥ì¸ë“¤ì˜ ì„¬ì„¸í•œ ì†œì”¨ë¥¼ ì—¿ë³¼ ìˆ˜ ìˆëŠ” ë¶€ë¶„ì…ë‹ˆë‹¤. íŠ¹íˆ ì •ë©´ì— ìˆëŠ” ê±°ëŒ€í•œ ì¥ë¯¸ì°½, ì¦‰ ë¡œì¦ˆ ìœˆë„ìš°ëŠ” ê·¸ í™”ë ¤í•¨ê³¼ ì›…ì¥í•¨ì´ ì••ê¶Œì¸ë°ìš”, ë¹›ì´ ì„±ë‹¹ ë‚´ë¶€ë¡œ ìŸì•„ì ¸ ë“¤ì–´ì˜¬ ë•Œë©´ ê·¸ì•¼ë§ë¡œ í™©í™€ê²½ì´ í¼ì³ì§‘ë‹ˆë‹¤. ë°¤ì´ ë˜ë©´ ì¡°ëª…ì— ë¹„ì¹œ ì„±ë‹¹ì˜ ëª¨ìŠµ ë˜í•œ í™˜ìƒì ì´ë‹ˆ, ë‚®ê³¼ ë°¤ ëª¨ë‘ ë°©ë¬¸í•´ì„œ ê·¸ ë§¤ë ¥ì„ ì§ì ‘ ëŠê»´ë³´ì‹œê¸¸ ì¶”ì²œí•©ë‹ˆë‹¤. ìŠ¤ë§ˆíŠ¸í° ê´‘ê° ë Œì¦ˆë¥¼ í™œìš©í•˜ë©´ ì´ ì›…ì¥í•œ ê±´ì¶•ë¬¼ì„ í•œ í”„ë ˆì„ì— ë‹´ì„ ìˆ˜ ìˆìœ¼ë‹ˆ, ìµœê³ ì˜ ì¸ìƒìƒ·ì„ ë‚¨ê²¨ë³´ì„¸ìš”!","voiceLang":"ko-KR","locationName":"Square du Palais de Justice","voiceQuery":"ì œëª© ì—†ìŒ","voiceName":null}]</script>
    
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ¯ ë¦¬ì›Œë“œ ì‹œìŠ¤í…œ: Referral ì¿ í‚¤ ì €ì¥ (2025-11-28)
        // URLì˜ ?ref=XXXX íŒŒë¼ë¯¸í„°ë¥¼ ê°ì§€í•˜ì—¬ 30ì¼ê°„ ì¿ í‚¤ì— ì €ì¥
        // ë‚˜ì¤‘ì— íšŒì›ê°€ì… ì‹œ ì„œë²„ì—ì„œ ì¿ í‚¤ í™•ì¸í•˜ì—¬ ì¶”ì²œì¸ ì—°ê²°
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        (function() {
            const urlParams = new URLSearchParams(window.location.search);
            const refCode = urlParams.get('ref');
            if (refCode) {
                // 30ì¼ê°„ ì¿ í‚¤ ì €ì¥
                const expires = new Date();
                expires.setDate(expires.getDate() + 30);
                document.cookie = 'referralCode=' + encodeURIComponent(refCode) + ';expires=' + expires.toUTCString() + ';path=/;SameSite=Lax';
                console.log('ğŸ Referral code saved:', refCode);
            }
        })();
        
        // ë°ì´í„° ë¡œë“œ
        const appData = JSON.parse(document.getElementById('app-data').textContent);
        const galleryView = document.getElementById('gallery-view');
        const detailView = document.getElementById('detail-view');
        const header = document.querySelector('.header');
        
        // Web Speech API
        const synth = window.speechSynthesis;
        let voices = [];
        let currentUtterance = null;
        
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // ğŸ”Š í‘œì¤€ ìŒì„± ë¡œì§ (2025-12-24) - guideDetailPage.jsì™€ ë™ì¼
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        let voiceConfigsCache = null;
        let voiceConfigsLoading = false;
        
        const DEFAULT_VOICE_PRIORITIES = {
            'ko-KR': { default: ['Microsoft Heami', 'Yuna'] },
            'en-US': { default: ['Samantha', 'Microsoft Zira', 'Google US English', 'English'] },
            'ja-JP': { default: ['Kyoko', 'Microsoft Haruka', 'Google æ—¥æœ¬èª', 'Japanese'] },
            'zh-CN': { default: ['Ting-Ting', 'Microsoft Huihui', 'Google æ™®é€šè¯', 'Chinese'] },
            'fr-FR': { default: ['Thomas', 'Microsoft Hortense', 'Google franÃ§ais', 'French'] },
            'de-DE': { default: ['Anna', 'Microsoft Hedda', 'Google Deutsch', 'German'] },
            'es-ES': { default: ['Monica', 'Microsoft Helena', 'Google espaÃ±ol', 'Spanish'] }
        };
        
        function detectPlatform() {
            const ua = navigator.userAgent;
            if (/iPhone|iPad|iPod/.test(ua)) return 'ios';
            if (/Android/.test(ua)) return 'android';
            return 'windows';
        }
        
        async function loadVoiceConfigsFromDB() {
            if (voiceConfigsCache) return voiceConfigsCache;
            if (voiceConfigsLoading) {
                await new Promise(resolve => setTimeout(resolve, 500));
                return voiceConfigsCache || null;
            }
            
            voiceConfigsLoading = true;
            try {
                const response = await fetch('/api/voice-configs');
                if (response.ok) {
                    const configs = await response.json();
                    voiceConfigsCache = {};
                    for (const config of configs) {
                        if (!voiceConfigsCache[config.langCode]) {
                            voiceConfigsCache[config.langCode] = {};
                        }
                        voiceConfigsCache[config.langCode][config.platform] = {
                            priorities: config.voicePriorities,
                            excludeVoices: config.excludeVoices || []
                        };
                    }
                    console.log('ğŸ”Š [ShareTemplate Voice DB] ì„¤ì • ë¡œë“œ ì™„ë£Œ:', Object.keys(voiceConfigsCache));
                }
            } catch (error) {
                console.warn('ğŸ”Š [ShareTemplate Voice DB] ë¡œë“œ ì‹¤íŒ¨, ê¸°ë³¸ê°’ ì‚¬ìš©:', error.message);
            }
            voiceConfigsLoading = false;
            return voiceConfigsCache;
        }
        
        function getVoicePriorityFromDB(langCode) {
            const platform = detectPlatform();
            
            if (voiceConfigsCache && voiceConfigsCache[langCode]) {
                const config = voiceConfigsCache[langCode][platform] || voiceConfigsCache[langCode]['default'];
                if (config) {
                    return { priorities: config.priorities, excludeVoices: config.excludeVoices };
                }
            }
            
            const fallback = DEFAULT_VOICE_PRIORITIES[langCode];
            if (fallback) {
                const priorities = fallback[platform] || fallback['default'] || fallback[Object.keys(fallback)[0]];
                return { priorities, excludeVoices: [] };
            }
            
            return { priorities: [], excludeVoices: [] };
        }
        
        function getVoiceForLanguage(userLang) {
            const langMap = {
                'ko': 'ko-KR', 'en': 'en-US', 'ja': 'ja-JP',
                'zh-CN': 'zh-CN', 'fr': 'fr-FR', 'de': 'de-DE', 'es': 'es-ES'
            };
            
            const fullLang = langMap[userLang] || 'ko-KR';
            const langCode = fullLang.substring(0, 2);
            
            const voiceConfig = getVoicePriorityFromDB(fullLang);
            const priorities = voiceConfig.priorities;
            const excludeVoices = voiceConfig.excludeVoices;
            
            const allVoices = synth.getVoices();
            let targetVoice = null;
            
            for (const voiceName of priorities) {
                targetVoice = allVoices.find(v => 
                    v.name.includes(voiceName) && !excludeVoices.some(ex => v.name.includes(ex))
                );
                if (targetVoice) break;
            }
            
            if (!targetVoice) {
                targetVoice = allVoices.find(v => 
                    v.lang.replace('_', '-').startsWith(langCode) && !excludeVoices.some(ex => v.name.includes(ex))
                );
            }
            
            console.log('[ShareTemplate TTS] userLang:', userLang, 'fullLang:', fullLang, 'â†’ voice:', targetVoice?.name);
            return targetVoice || allVoices[0];
        }
        
        // ì•± ì‹œì‘ ì‹œ ìŒì„± ì„¤ì • ë¡œë“œ
        loadVoiceConfigsFromDB();
        
        function populateVoiceList() {
            voices = synth.getVoices();
        }
        
        function stopAudio() {
            if (synth.speaking) {
                synth.pause();
                synth.cancel();
            }
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');
            if (playIcon) playIcon.style.display = 'block';
            if (pauseIcon) pauseIcon.style.display = 'none';
        }
        
        // ğŸ¤ 2025-12-24: í‘œì¤€ ìŒì„± ë¡œì§ - ì‚¬ìš©ì ì–¸ì–´ ê¸°ì¤€ TTS ì¬ìƒ
        function playAudio(text, voiceLang) {
            stopAudio();
            
            // âš ï¸ **í•µì‹¬ ë¡œì§ - ì ˆëŒ€ ìˆ˜ì • ê¸ˆì§€!** (2025-10-03 ì¹˜ëª…ì  ë²„ê·¸ í•´ê²°)
            const cleanText = text.replace(new RegExp('<br\s*/?>', 'gi'), ' ');
            
            // ë¬¸ì¥ ë¶„ë¦¬ ë° í•˜ì´ë¼ì´íŠ¸ ì¤€ë¹„
            const sentences = cleanText.match(/[^.!?]+[.!?]+/g) || [cleanText];
            const textElement = document.getElementById('detail-description');
            
            // ì›ë³¸ í…ìŠ¤íŠ¸ ì €ì¥
            const originalText = cleanText;
            
            currentUtterance = new SpeechSynthesisUtterance(cleanText);
            
            // ğŸ”Š í‘œì¤€ ìŒì„± ë¡œì§: URL lang íŒŒë¼ë¯¸í„° ë˜ëŠ” appLanguage ê¸°ì¤€
            const urlParams = new URLSearchParams(window.location.search);
            const urlLang = urlParams.get('lang');
            const userLang = urlLang || localStorage.getItem('appLanguage') || 'ko';
            const langCodeMap = { 'ko': 'ko-KR', 'en': 'en-US', 'ja': 'ja-JP', 'zh-CN': 'zh-CN', 'fr': 'fr-FR', 'de': 'de-DE', 'es': 'es-ES' };
            const langCode = langCodeMap[userLang] || 'ko-KR';
            
            const allVoices = synth.getVoices();
            let targetVoice = null;
            
            // â­ í•œêµ­ì–´ í•˜ë“œì½”ë”© (Yuna â†’ Sora â†’ ìœ ë‚˜ â†’ ì†Œë¼ â†’ Heami)
            if (langCode === 'ko-KR' || langCode.startsWith('ko')) {
                const koVoices = allVoices.filter(v => v.lang.startsWith('ko'));
                targetVoice = koVoices.find(v => v.name.includes('Yuna'))
                           || koVoices.find(v => v.name.includes('Sora'))
                           || koVoices.find(v => v.name.includes('ìœ ë‚˜'))
                           || koVoices.find(v => v.name.includes('ì†Œë¼'))
                           || koVoices.find(v => v.name.includes('Heami'))
                           || koVoices[0];
                console.log('[ShareTemplate TTS] í•œêµ­ì–´ ìŒì„±:', targetVoice?.name || 'default');
            } else {
                // ë‹¤ë¥¸ ì–¸ì–´: DB voice_configs ë˜ëŠ” ê¸°ë³¸ê°’
                targetVoice = getVoiceForLanguage(userLang);
            }
            
            currentUtterance.voice = targetVoice || null;
            currentUtterance.lang = langCode;
            currentUtterance.rate = 1.0;
            
            console.log('[ShareTemplate TTS] ì–¸ì–´:', langCode, 'ìŒì„±:', targetVoice ? targetVoice.name : 'default');
            
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');
            
            let currentSentenceIndex = 0;
            
            currentUtterance.onstart = () => {
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            };
            
            // ë‹¨ì–´ ê²½ê³„ë§ˆë‹¤ í•˜ì´ë¼ì´íŠ¸
            currentUtterance.onboundary = (event) => {
                if (event.name === 'sentence') {
                    // í˜„ì¬ ë¬¸ì¥ í•˜ì´ë¼ì´íŠ¸
                    const highlightedHTML = sentences.map((sentence, idx) => {
                        if (idx === currentSentenceIndex) {
                            return '<span class="current-sentence" style="background-color: rgba(66, 133, 244, 0.3); font-weight: 600;">' + sentence + '</span>';
                        }
                        return sentence;
                    }).join('');
                    
                    textElement.innerHTML = highlightedHTML;
                    currentSentenceIndex++;
                    
                    // ğŸ”„ 2025-01-21: í•˜ì´ë¼ì´íŠ¸ëœ ë¬¸ì¥ìœ¼ë¡œ ìë™ ìŠ¤í¬ë¡¤ (ë¶€ë“œëŸ½ê²Œ)
                    const currentSpan = textElement.querySelector('.current-sentence');
                    if (currentSpan) {
                        currentSpan.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }
            };
            
            currentUtterance.onend = () => {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
                // í•˜ì´ë¼ì´íŠ¸ ì œê±°, ì›ë³¸ ë³µì›
                textElement.textContent = originalText;
            };
            
            synth.speak(currentUtterance);
        }
        
        populateVoiceList();
        if (synth.onvoiceschanged !== undefined) {
            synth.onvoiceschanged = populateVoiceList;
        }
        
        // ğŸ¤ í˜„ì¬ ë³´ê³  ìˆëŠ” ì•„ì´í…œì˜ voiceLang ì €ì¥
        let currentVoiceLang = null;
        
        // ğŸŒ 2025-12-24: ë™ì  ì½˜í…ì¸  ê°•ì œ ì¬ë²ˆì—­ í•¨ìˆ˜
        let retranslationPending = false;
        
        function retranslateNewContent() {
            // ğŸŒ 2025-12-24: userLang ì²´í¬ ì œê±° - Google Translate ë“œë¡­ë‹¤ìš´ í™œì„±í™” ì—¬ë¶€ë§Œ í™•ì¸
            return new Promise((resolve) => {
                const selectElement = document.querySelector('.goog-te-combo');
                
                if (!selectElement || !selectElement.value) {
                    console.log('[Gallery Retranslate] Google Translate ë“œë¡­ë‹¤ìš´ ë¹„í™œì„± - ìŠ¤í‚µ');
                    resolve();
                    return;
                }
                
                const currentLang = selectElement.value;
                console.log('[Gallery Retranslate] ğŸ”„ ê°•ì œ ì¬ë²ˆì—­ ì‹œì‘:', currentLang);
                retranslationPending = true;
                
                selectElement.value = '';
                selectElement.dispatchEvent(new Event('change'));
                
                setTimeout(() => {
                    selectElement.value = currentLang;
                    selectElement.dispatchEvent(new Event('change'));
                    
                    setTimeout(() => {
                        console.log('[Gallery Retranslate] âœ… ì¬ë²ˆì—­ ì™„ë£Œ');
                        retranslationPending = false;
                        window.dispatchEvent(new CustomEvent('galleryRetranslationComplete'));
                        resolve();
                    }, 800);
                }, 100);
            });
        }
        
        // ê°¤ëŸ¬ë¦¬ ì•„ì´í…œ í´ë¦­ (ì•±ê³¼ 100% ë™ì¼í•œ ë¡œì§)
        document.querySelectorAll('.gallery-item').forEach(item => {
            item.addEventListener('click', () => {
                const itemData = appData[parseInt(item.dataset.id)];
                
                // ğŸ¤ í˜„ì¬ ì•„ì´í…œì˜ voiceLang ì €ì¥ (DBì—ì„œ ê°€ì ¸ì˜¨ ê°’ ê·¸ëŒ€ë¡œ)
                currentVoiceLang = itemData.voiceLang;
                
                // ğŸ¤ ìŒì„± ëª¨ë“œ íŒë³„: ì´ë¯¸ì§€ ì—†ê³  voiceQuery ìˆìœ¼ë©´ ìŒì„± ëª¨ë“œ
                const hasImage = itemData.imageDataUrl && !itemData.imageDataUrl.includes('iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAY');
                const isVoiceGuide = !hasImage && itemData.voiceQuery;
                
                // ğŸ¨ ë°°ê²½ ì´ë¯¸ì§€ ì„¤ì • (ìŒì„± ëª¨ë“œë©´ ë¡œê³  ì´ë¯¸ì§€ ì‚¬ìš©)
                const bgElement = document.getElementById('detail-bg');
                if (hasImage) {
                    bgElement.src = itemData.imageDataUrl;
                    bgElement.style.filter = '';
                } else {
                    // ìŒì„± ëª¨ë“œ: ë¡œê³  ì´ë¯¸ì§€ + blur íš¨ê³¼
                    bgElement.src = '/images/landing-logo.jpg';
                    bgElement.style.filter = 'blur(8px) brightness(0.7)';
                }
                
                // ğŸ“ ìœ„ì¹˜ì •ë³´ì°½ / ğŸ¤ ìŒì„±í‚¤ì›Œë“œì°½ ì²˜ë¦¬
                const locationInfo = document.getElementById('detail-location-info');
                const locationName = document.getElementById('detail-location-name');
                const voiceQueryInfo = document.getElementById('detail-voice-query-info');
                const voiceQueryText = document.getElementById('detail-voice-query-text');
                
                if (isVoiceGuide) {
                    // ìŒì„± ëª¨ë“œ: voiceQueryInfo í‘œì‹œ, locationInfo ìˆ¨ê¹€
                    locationInfo.classList.add('hidden');
                    locationInfo.style.display = 'none';
                    if (voiceQueryInfo && voiceQueryText) {
                        // ğŸ¤ voiceQuery || title í´ë°± (DBì— voiceQuery ì—†ìœ¼ë©´ title ì‚¬ìš©)
                        voiceQueryText.textContent = itemData.voiceQuery || itemData.title || '';
                        voiceQueryInfo.classList.remove('hidden');
                        voiceQueryInfo.style.display = 'flex';
                    }
                    console.log('[Share] ìŒì„± ëª¨ë“œ:', itemData.voiceQuery || itemData.title);
                } else {
                    // ì´ë¯¸ì§€ ëª¨ë“œ: locationInfo í•­ìƒ í‘œì‹œ (ì—†ìœ¼ë©´ 'ìœ„ì¹˜ ì •ë³´ ì—†ìŒ'), voiceQueryInfo ìˆ¨ê¹€
                    voiceQueryInfo.classList.add('hidden');
                    voiceQueryInfo.style.display = 'none';
                    // ğŸ“ locationNameì´ ì—†ì–´ë„ íŒ¨ë„ í‘œì‹œ (ìœ„ì¹˜ ì •ë³´ ì—†ìŒ)
                    locationName.textContent = itemData.locationName || 'ìœ„ì¹˜ ì •ë³´ ì—†ìŒ';
                    locationInfo.classList.remove('hidden');
                    locationInfo.style.display = 'flex';
                    console.log('[Share] ì´ë¯¸ì§€ ëª¨ë“œ:', itemData.locationName || '(ìœ„ì¹˜ ì •ë³´ ì—†ìŒ)');
                }
                
                // í…ìŠ¤íŠ¸ ì„¤ì •
                document.getElementById('detail-description').textContent = itemData.description;
                
                // UI í‘œì‹œ
                galleryView.classList.add('hidden');
                header.classList.add('hidden');
                detailView.classList.remove('hidden');
                document.getElementById('detail-footer').classList.remove('hidden');
                
                // í…ìŠ¤íŠ¸ëŠ” í‘œì‹œ ìƒíƒœë¡œ ì‹œì‘ (ìŒì„±ê³¼ ë™ì‹œì— ë³´ì„)
                document.getElementById('detail-text').classList.remove('hidden');
                
                // ğŸŒ 2025-12-24: ë™ì  ì½˜í…ì¸  ì¬ë²ˆì—­ í›„ TTS ì¬ìƒ
                retranslateNewContent().then(() => {
                    // ğŸ¤ ìŒì„± ìë™ ì¬ìƒ (ì €ì¥ëœ ì–¸ì–´ ì‚¬ìš©)
                    playAudio(itemData.description, currentVoiceLang);
                });
            });
        });
        
        // ğŸ”™ ë³´ê´€í•¨ìœ¼ë¡œ ëŒì•„ê°€ê¸° ë²„íŠ¼ (ê°¤ëŸ¬ë¦¬ ë·°)
        const galleryBackBtn = document.getElementById('gallery-back-btn');
        if (galleryBackBtn) {
            galleryBackBtn.addEventListener('click', () => {
                window.location.href = '/#archive';
            });
        }
        
        // ë’¤ë¡œ ê°€ê¸°
        document.getElementById('detail-back').addEventListener('click', () => {
            stopAudio();
            detailView.classList.add('hidden');
            document.getElementById('detail-text').classList.add('hidden');
            document.getElementById('detail-footer').classList.add('hidden');
            header.classList.remove('hidden');
            galleryView.classList.remove('hidden');
        });
        
        // í…ìŠ¤íŠ¸ í† ê¸€ ë²„íŠ¼ (ì•±ê³¼ ë™ì¼í•œ ë¡œì§)
        document.getElementById('text-toggle')?.addEventListener('click', () => {
            document.getElementById('detail-text').classList.toggle('hidden');
        });
        
        // ìŒì„± ì¬ìƒ/ì •ì§€
        document.getElementById('detail-audio').addEventListener('click', () => {
            if (synth.speaking) {
                stopAudio();
            } else {
                const text = document.getElementById('detail-description').textContent;
                // ğŸ¤ ì €ì¥ëœ ì–¸ì–´ ì‚¬ìš©
                playAudio(text, currentVoiceLang);
            }
        });
        
        // í™ˆ ë²„íŠ¼ (ê°¤ëŸ¬ë¦¬ í•˜ë‹¨)
        const homeButton = document.getElementById('home-button');
        if (homeButton) {
            homeButton.addEventListener('click', (e) => {
                e.preventDefault();
                stopAudio();
                setTimeout(() => {
                    window.location.href = homeButton.href;
                }, 200);
            });
        }
        
        // í™ˆ ë²„íŠ¼ (ìƒì„¸ ë·° í•˜ë‹¨) - ìŒì„± ë“£ë‹¤ê°€ ë°”ë¡œ ì•±ìœ¼ë¡œ ê°€ê¸°
        const detailHome = document.getElementById('detail-home');
        if (detailHome) {
            detailHome.addEventListener('click', (e) => {
                e.preventDefault();
                stopAudio();
                setTimeout(() => {
                    window.location.href = detailHome.href;
                }, 200);
            });
        }
        
        // í˜ì´ì§€ ì´íƒˆ ì‹œ ì˜¤ë””ì˜¤ ì •ì§€ (ë°±ê·¸ë¼ìš´ë“œ ì¬ìƒ ë°©ì§€)
        window.addEventListener('beforeunload', () => {
            stopAudio();
        });
    </script>
    
    <!-- âš ï¸ í•µì‹¬ ë¡œì§: Service Worker ë“±ë¡ (ì˜¤í”„ë¼ì¸ ì§€ì›) -->
    <script>
        // Service Worker ì§€ì› í™•ì¸ ë° ë“±ë¡ (v10 - ê³µìœ í˜ì´ì§€ ì „ìš© Network First)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw-share.js')
                    .then(registration => {
                        console.log('âœ… [SW-Share] v10 ë“±ë¡ ì„±ê³µ:', registration.scope);
                    })
                    .catch(error => {
                        console.log('âŒ [SW-Share] ë“±ë¡ ì‹¤íŒ¨:', error);
                    });
            });
        }
    </script>

    <!-- Google Translate Widget (ìˆ¨ê¹€) -->
    <div id="google_translate_element" style="display:none;"></div>

    <!-- Google Translate Initialization -->
    <!-- ğŸŒ ì¿ í‚¤ëŠ” <head>ì—ì„œ ë¯¸ë¦¬ ì„¤ì •ë¨ (êµ¬ê¸€ ë²ˆì—­ ë¡œë“œ ì „) -->
    <script type="text/javascript">
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'auto', // ğŸŒ 2025-12-24: ì–‘ë°©í–¥ ë²ˆì—­
                includedLanguages: 'ko,en,ja,zh-CN,fr,de,es',
                autoDisplay: false
            }, 'google_translate_element');
        }
    </script>
    <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

    <!-- Google Translate CSS ìˆ¨ê¹€ -->
    <style>
        .goog-te-banner-frame { display: none !important; }
        body { top: 0px !important; }
        .goog-te-gadget { font-size: 0px !important; color: transparent !important; }
        .goog-logo-link { display: none !important; }
        .skiptranslate { display: none !important; }
        /* êµ¬ê¸€ ë²ˆì—­ ìŠ¤í”¼ë„ˆ ì™„ì „ ìˆ¨ê¹€ */
        .goog-te-spinner-pos { display: none !important; }
        .goog-te-spinner { display: none !important; }
        .goog-te-spinner-animation { display: none !important; }
    </style>
    
    <!-- ğŸ”Š 2025-12-25: ì™¸ë¶€ TTS ë¡œì§ (ê¸°ì¡´ DB í˜ì´ì§€ë„ ë™ì  ì—…ë°ì´íŠ¸) -->
    <script src="/share-page.js"></script>
</body>
</html>