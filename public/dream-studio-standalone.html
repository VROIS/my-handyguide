<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ¬ ë“œë¦¼ ìŠ¤íŠœë””ì˜¤ í…ŒìŠ¤íŠ¸ | Google AI Studioìš©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { 
            font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: white;
        }
        
        /* ê³µìœ  í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
        .share-container {
            max-width: 430px;
            margin: 0 auto;
            background: #0f0f23;
            min-height: 100vh;
        }
        
        .header {
            padding: 16px;
            background: rgba(0,0,0,0.3);
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        /* ê°€ì´ë“œ ìƒì„¸ ë·° */
        .guide-detail {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: #0f0f23;
            z-index: 100;
            overflow-y: auto;
        }
        
        .guide-detail.active { display: block; }
        
        .detail-image-container {
            position: relative;
            width: 100%;
            aspect-ratio: 3/4;
            overflow: hidden;
            background: #000;
        }
        
        .detail-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        /* Ken Burns íš¨ê³¼ */
        @keyframes kenBurnsZoomIn {
            0% { transform: scale(1) translate(0, 0); }
            100% { transform: scale(1.3) translate(-5%, -5%); }
        }
        @keyframes kenBurnsZoomOut {
            0% { transform: scale(1.3) translate(-5%, -5%); }
            100% { transform: scale(1) translate(0, 0); }
        }
        @keyframes kenBurnsPanLeft {
            0% { transform: scale(1.2) translate(10%, 0); }
            100% { transform: scale(1.2) translate(-10%, 0); }
        }
        @keyframes kenBurnsPanRight {
            0% { transform: scale(1.2) translate(-10%, 0); }
            100% { transform: scale(1.2) translate(10%, 0); }
        }
        
        .ken-burns-zoom-in { animation: kenBurnsZoomIn 20s ease-in-out forwards; }
        .ken-burns-zoom-out { animation: kenBurnsZoomOut 20s ease-in-out forwards; }
        .ken-burns-pan-left { animation: kenBurnsPanLeft 20s ease-in-out forwards; }
        .ken-burns-pan-right { animation: kenBurnsPanRight 20s ease-in-out forwards; }
        
        /* ìë§‰ */
        .subtitle-overlay {
            position: absolute;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            text-align: center;
        }
        
        .subtitle-text {
            background: rgba(0,0,0,0.75);
            color: white;
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 16px;
            line-height: 1.6;
            display: inline-block;
            max-width: 100%;
        }
        
        .subtitle-word { transition: color 0.2s, font-weight 0.2s; }
        .subtitle-word.active { color: #fbbf24; font-weight: bold; }
        .subtitle-word.spoken { color: #9ca3af; }
        
        /* ì¬ìƒ ë²„íŠ¼ */
        .play-btn {
            position: absolute;
            bottom: 16px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            background: rgba(255,255,255,0.95);
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 20px rgba(0,0,0,0.4);
        }
        
        .play-btn:hover { background: white; }
        
        /* ë‹«ê¸° ë²„íŠ¼ */
        .close-btn {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 40px;
            height: 40px;
            background: rgba(0,0,0,0.5);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 24px;
            cursor: pointer;
            z-index: 10;
        }
        
        /* ì„¤ëª… ì˜ì—­ */
        .detail-content {
            padding: 20px;
            background: #0f0f23;
        }
        
        .persona-badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 13px;
            margin-bottom: 12px;
        }
        
        .description-text {
            font-size: 16px;
            line-height: 1.8;
            color: #e5e5e5;
        }
        
        /* í”„ë¡¬í”„íŠ¸ íŒ¨ë„ */
        .prompt-panel {
            background: #1a1a2e;
            border: 1px solid #333;
            border-radius: 12px;
            padding: 16px;
            margin: 16px;
        }
        
        .prompt-panel h3 {
            color: #fbbf24;
            margin-bottom: 12px;
            font-size: 14px;
        }
        
        .prompt-box {
            background: #0d0d1a;
            border: 1px solid #444;
            border-radius: 8px;
            padding: 12px;
            font-size: 13px;
            color: #ccc;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }
        
        .copy-btn {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            margin-top: 10px;
        }
        
        .copy-btn:hover { background: #4338ca; }
        
        /* ì…ë ¥ ì˜ì—­ */
        .input-area {
            padding: 16px;
        }
        
        .upload-zone {
            border: 2px dashed #444;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }
        
        .upload-zone:hover { border-color: #667eea; }
        
        .upload-zone.has-image {
            padding: 0;
            border: none;
        }
        
        .upload-zone img {
            width: 100%;
            border-radius: 12px;
        }
        
        textarea {
            width: 100%;
            background: #1a1a2e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 12px;
            color: white;
            font-size: 14px;
            resize: vertical;
            min-height: 120px;
            margin-top: 16px;
        }
        
        textarea::placeholder { color: #666; }
        
        .test-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 16px;
        }
        
        .test-btn:hover { opacity: 0.9; }
        
        /* íš¨ê³¼ ì„ íƒ */
        .effect-selector {
            display: flex;
            gap: 8px;
            margin-top: 16px;
            flex-wrap: wrap;
        }
        
        .effect-btn {
            padding: 8px 16px;
            background: #2a2a4a;
            border: 1px solid #444;
            border-radius: 20px;
            color: #ccc;
            font-size: 13px;
            cursor: pointer;
        }
        
        .effect-btn.active {
            background: #4f46e5;
            border-color: #4f46e5;
            color: white;
        }
    </style>
</head>
<body>
    <div class="share-container">
        <!-- í—¤ë” -->
        <div class="header">
            <h1 class="text-xl font-bold">ğŸ¬ ë“œë¦¼ ìŠ¤íŠœë””ì˜¤</h1>
            <p class="text-gray-400 text-sm mt-1">Google AI Studio í…ŒìŠ¤íŠ¸ìš©</p>
        </div>
        
        <!-- ë©”ì¸ ì»¨í…ì¸  -->
        <div class="input-area">
            <!-- ì´ë¯¸ì§€ ì—…ë¡œë“œ -->
            <div class="upload-zone" id="uploadZone" onclick="document.getElementById('imageInput').click()">
                <input type="file" id="imageInput" accept="image/*" style="display:none" onchange="handleImageUpload(event)">
                <div id="uploadPlaceholder">
                    <div class="text-4xl mb-3">ğŸ“·</div>
                    <p class="text-gray-400">ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                    <p class="text-gray-500 text-sm mt-1">í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸</p>
                </div>
                <img id="previewImage" src="" alt="" style="display:none">
            </div>
            
            <!-- í”„ë¡¬í”„íŠ¸ ë³µì‚¬ -->
            <div class="prompt-panel">
                <h3>ğŸ“‹ Google AI Studioì— ë³µì‚¬í•  í”„ë¡¬í”„íŠ¸</h3>
                <div class="prompt-box" id="promptText">ë‹¹ì‹ ì€ ì´ ì´ë¯¸ì§€ ì† ì£¼ì¸ê³µ(ìŒì‹, ê±´ë¬¼, ì˜ˆìˆ í’ˆ, í’ê²½, ì™€ì¸ ë“±)ì…ë‹ˆë‹¤.
1ì¸ì¹­ ì‹œì ìœ¼ë¡œ ìì‹ ì„ ì†Œê°œí•˜ê³  ì´ì•¼ê¸°ë¥¼ ë“¤ë ¤ì£¼ì„¸ìš”.
15-30ì´ˆ ë¶„ëŸ‰(í•œêµ­ì–´ 80-120ì)ìœ¼ë¡œ ê°ì •ì´ ë‹´ê¸´ ëŒ€ì‚¬ë¥¼ ì‘ì„±í•˜ì„¸ìš”.

ì˜ˆì‹œ:
- ì™€ì¸: "ì•ˆë…•, ë‚˜ëŠ” 1892ë…„ ë³´ë¥´ë„ì—ì„œ íƒœì–´ë‚¬ì–´. 130ë…„ ë™ì•ˆ ì´ ì§€í•˜ ì €ì¥ê³ ì—ì„œ..."
- ì—í íƒ‘: "íŒŒë¦¬ì˜ ë°¤í•˜ëŠ˜ ì•„ë˜, ë‚˜ëŠ” ë§¤ì¼ ìˆ˜ë°±ë§Œ ê°œì˜ ë¶ˆë¹›ìœ¼ë¡œ ë°˜ì§ì´ì§€..."
- ì´ˆë°¥: "ë‚˜ëŠ” ì˜¤ëŠ˜ ì•„ì¹¨ ì¸ í‚¤ì§€ ì‹œì¥ì—ì„œ ê°“ ì¡íŒ ì°¸ì¹˜ì•¼..."

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µ:
- í˜ë¥´ì†Œë‚˜: (í”¼ì‚¬ì²´ ì •ì²´)
- ë¶„ìœ„ê¸°: (nostalgic, proud, mysterious, cheerful ë“±)
- ëŒ€ì‚¬: "1ì¸ì¹­ ëŒ€ì‚¬"</div>
                <button class="copy-btn" onclick="copyPrompt()">ğŸ“‹ í”„ë¡¬í”„íŠ¸ ë³µì‚¬</button>
            </div>
            
            <!-- AI ì‘ë‹µ ë¶™ì—¬ë„£ê¸° -->
            <textarea id="aiResponse" placeholder="Google AI Studio ì‘ë‹µì„ ì—¬ê¸°ì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”...

ì˜ˆì‹œ:
- í˜ë¥´ì†Œë‚˜: 100ë…„ ëœ ì™€ì¸ë³‘
- ë¶„ìœ„ê¸°: nostalgic
- ëŒ€ì‚¬: &quot;ì•ˆë…•, ë‚˜ëŠ” 1892ë…„ ë³´ë¥´ë„ì—ì„œ íƒœì–´ë‚œ ì™€ì¸ì´ì•¼. 130ë…„ ë™ì•ˆ ì´ ì–´ë‘ìš´ ì €ì¥ê³ ì—ì„œ ì¡°ìš©íˆ ìˆ™ì„±ë˜ì–´ ì™”ì–´.&quot;"></textarea>
            
            <!-- Ken Burns íš¨ê³¼ ì„ íƒ -->
            <div class="effect-selector">
                <button class="effect-btn active" data-effect="zoom-in" onclick="selectEffect('zoom-in')">Zoom In</button>
                <button class="effect-btn" data-effect="zoom-out" onclick="selectEffect('zoom-out')">Zoom Out</button>
                <button class="effect-btn" data-effect="pan-left" onclick="selectEffect('pan-left')">Pan Left</button>
                <button class="effect-btn" data-effect="pan-right" onclick="selectEffect('pan-right')">Pan Right</button>
            </div>
            
            <!-- í…ŒìŠ¤íŠ¸ ë²„íŠ¼ -->
            <button class="test-btn" onclick="startTest()">â–¶ï¸ ë“œë¦¼ ìŠ¤íŠœë””ì˜¤ í…ŒìŠ¤íŠ¸</button>
        </div>
        
        <!-- TTS í”„ë¡¬í”„íŠ¸ (ìŒì„±ìš©) -->
        <div class="prompt-panel">
            <h3>ğŸ™ï¸ TTS í…ŒìŠ¤íŠ¸ìš© í”„ë¡¬í”„íŠ¸ (Gemini 2.5 Flash TTS)</h3>
            <div class="prompt-box" id="ttsPromptText">ë”°ëœ»í•˜ê³  í–¥ìˆ˜ ì–´ë¦° í†¤ìœ¼ë¡œ ë§í•´ì£¼ì„¸ìš”:

"(ì—¬ê¸°ì— ìœ„ì—ì„œ ìƒì„±ëœ ëŒ€ì‚¬ë¥¼ ë„£ìœ¼ì„¸ìš”)"

Voice: Kore (í•œêµ­ì–´) / Puck (ì˜ì–´) / Aoede (ì¼ë³¸ì–´)</div>
            <button class="copy-btn" onclick="copyTTSPrompt()">ğŸ“‹ TTS í”„ë¡¬í”„íŠ¸ ë³µì‚¬</button>
        </div>
        
        <!-- ì•ˆë‚´ -->
        <div class="p-4 text-gray-500 text-xs">
            <p class="mb-2"><strong>ğŸ“‹ í…ŒìŠ¤íŠ¸ ë°©ë²•:</strong></p>
            <ol class="list-decimal list-inside space-y-1">
                <li>ì´ë¯¸ì§€ ì—…ë¡œë“œ</li>
                <li>í”„ë¡¬í”„íŠ¸ ë³µì‚¬ â†’ Google AI Studioì— ë¶™ì—¬ë„£ê¸°</li>
                <li>AI ì‘ë‹µì„ ì•„ë˜ í…ìŠ¤íŠ¸ ì˜ì—­ì— ë¶™ì—¬ë„£ê¸°</li>
                <li>"ë“œë¦¼ ìŠ¤íŠœë””ì˜¤ í…ŒìŠ¤íŠ¸" ë²„íŠ¼ í´ë¦­</li>
                <li>Ken Burns íš¨ê³¼ + ë¸Œë¼ìš°ì € TTSë¡œ ë¯¸ë¦¬ë³´ê¸°</li>
            </ol>
            <p class="mt-3 text-yellow-500">ğŸ’¡ ì‹¤ì œ Gemini TTSëŠ” AI Studio Audio íƒ­ì—ì„œ í…ŒìŠ¤íŠ¸!</p>
        </div>
    </div>
    
    <!-- ê°€ì´ë“œ ìƒì„¸ ë·° (ê³µìœ  í˜ì´ì§€ ìŠ¤íƒ€ì¼) -->
    <div class="guide-detail" id="guideDetail">
        <div class="detail-image-container">
            <button class="close-btn" onclick="closeDetail()">âœ•</button>
            <img class="detail-image" id="detailImage" src="" alt="">
            <div class="subtitle-overlay">
                <div class="subtitle-text" id="subtitleText">ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”</div>
            </div>
            <button class="play-btn" id="playBtn" onclick="togglePlay()">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3" fill="currentColor"/>
                </svg>
            </button>
        </div>
        <div class="detail-content">
            <div class="persona-badge" id="personaBadge">ğŸ­ í˜ë¥´ì†Œë‚˜</div>
            <p class="description-text" id="descriptionText">AIê°€ ìƒì„±í•œ 1ì¸ì¹­ ëŒ€ì‚¬ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</p>
        </div>
    </div>

    <script>
        let uploadedImage = null;
        let currentEffect = 'zoom-in';
        let isPlaying = false;
        let currentScript = '';
        let currentPersona = '';
        let currentMood = '';
        
        // ì´ë¯¸ì§€ ì—…ë¡œë“œ
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (e) => {
                uploadedImage = e.target.result;
                document.getElementById('previewImage').src = uploadedImage;
                document.getElementById('previewImage').style.display = 'block';
                document.getElementById('uploadPlaceholder').style.display = 'none';
                document.getElementById('uploadZone').classList.add('has-image');
            };
            reader.readAsDataURL(file);
        }
        
        // í”„ë¡¬í”„íŠ¸ ë³µì‚¬
        function copyPrompt() {
            const text = document.getElementById('promptText').textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('í”„ë¡¬í”„íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! Google AI Studioì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.');
            });
        }
        
        // TTS í”„ë¡¬í”„íŠ¸ ë³µì‚¬
        function copyTTSPrompt() {
            let text = document.getElementById('ttsPromptText').textContent;
            if (currentScript) {
                text = text.replace('(ì—¬ê¸°ì— ìœ„ì—ì„œ ìƒì„±ëœ ëŒ€ì‚¬ë¥¼ ë„£ìœ¼ì„¸ìš”)', currentScript);
            }
            navigator.clipboard.writeText(text).then(() => {
                alert('TTS í”„ë¡¬í”„íŠ¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
            });
        }
        
        // íš¨ê³¼ ì„ íƒ
        function selectEffect(effect) {
            currentEffect = effect;
            document.querySelectorAll('.effect-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-effect="${effect}"]`).classList.add('active');
        }
        
        // AI ì‘ë‹µ íŒŒì‹±
        function parseAIResponse(text) {
            const lines = text.split('\n');
            let persona = 'ì•Œ ìˆ˜ ì—†ìŒ';
            let mood = 'cheerful';
            let script = '';
            
            for (const line of lines) {
                if (line.includes('í˜ë¥´ì†Œë‚˜:') || line.includes('Persona:')) {
                    persona = line.split(':').slice(1).join(':').trim();
                } else if (line.includes('ë¶„ìœ„ê¸°:') || line.includes('Mood:')) {
                    mood = line.split(':').slice(1).join(':').trim().toLowerCase();
                } else if (line.includes('ëŒ€ì‚¬:') || line.includes('Script:')) {
                    script = line.split(':').slice(1).join(':').trim().replace(/^["']|["']$/g, '');
                }
            }
            
            // ëŒ€ì‚¬ë¥¼ ì°¾ì§€ ëª»í•˜ë©´ ë”°ì˜´í‘œ ì•ˆì˜ í…ìŠ¤íŠ¸ ì°¾ê¸°
            if (!script) {
                const quoteMatch = text.match(/[""]([^""]+)[""]/);
                if (quoteMatch) script = quoteMatch[1];
            }
            
            // ê·¸ë˜ë„ ì—†ìœ¼ë©´ ì „ì²´ í…ìŠ¤íŠ¸ ì‚¬ìš©
            if (!script) script = text.substring(0, 200);
            
            return { persona, mood, script };
        }
        
        // í…ŒìŠ¤íŠ¸ ì‹œì‘
        function startTest() {
            if (!uploadedImage) {
                alert('ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ì—…ë¡œë“œí•˜ì„¸ìš”!');
                return;
            }
            
            const response = document.getElementById('aiResponse').value.trim();
            if (!response) {
                alert('Google AI Studio ì‘ë‹µì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”!');
                return;
            }
            
            const parsed = parseAIResponse(response);
            currentPersona = parsed.persona;
            currentMood = parsed.mood;
            currentScript = parsed.script;
            
            // ìƒì„¸ ë·° ì—´ê¸°
            document.getElementById('detailImage').src = uploadedImage;
            document.getElementById('personaBadge').textContent = `ğŸ­ ${currentPersona} (${currentMood})`;
            document.getElementById('descriptionText').textContent = currentScript;
            document.getElementById('subtitleText').textContent = 'ì¬ìƒ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì‹œì‘í•˜ì„¸ìš”';
            document.getElementById('guideDetail').classList.add('active');
            
            // TTS í”„ë¡¬í”„íŠ¸ ì—…ë°ì´íŠ¸
            updateTTSPrompt();
        }
        
        // TTS í”„ë¡¬í”„íŠ¸ ì—…ë°ì´íŠ¸
        function updateTTSPrompt() {
            const moodMap = {
                'nostalgic': 'ë”°ëœ»í•˜ê³  í–¥ìˆ˜ ì–´ë¦° í†¤ìœ¼ë¡œ',
                'proud': 'ìë‘ìŠ¤ëŸ½ê³  ë‹¹ë‹¹í•œ í†¤ìœ¼ë¡œ',
                'mysterious': 'ì‹ ë¹„ë¡­ê³  í¥ë¯¸ë¡œìš´ í†¤ìœ¼ë¡œ',
                'cheerful': 'ë°ê³  í™œê¸°ì°¬ í†¤ìœ¼ë¡œ',
                'peaceful': 'í‰ì˜¨í•˜ê³  ì°¨ë¶„í•œ í†¤ìœ¼ë¡œ',
                'dramatic': 'ê·¹ì ì´ê³  ê°ì •ì ì¸ í†¤ìœ¼ë¡œ'
            };
            
            const moodText = moodMap[currentMood] || moodMap.cheerful;
            document.getElementById('ttsPromptText').textContent = `${moodText} ë§í•´ì£¼ì„¸ìš”:

"${currentScript}"

Voice: Kore (í•œêµ­ì–´) / Puck (ì˜ì–´) / Aoede (ì¼ë³¸ì–´)`;
        }
        
        // ìƒì„¸ ë·° ë‹«ê¸°
        function closeDetail() {
            stopPlay();
            document.getElementById('guideDetail').classList.remove('active');
            document.getElementById('detailImage').className = 'detail-image';
        }
        
        // ì¬ìƒ í† ê¸€
        function togglePlay() {
            if (isPlaying) {
                stopPlay();
            } else {
                startPlay();
            }
        }
        
        // ì¬ìƒ ì‹œì‘
        function startPlay() {
            if (!currentScript) return;
            
            isPlaying = true;
            
            // ë²„íŠ¼ ë³€ê²½
            document.getElementById('playBtn').innerHTML = `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="6" y="4" width="4" height="16" fill="currentColor"/>
                    <rect x="14" y="4" width="4" height="16" fill="currentColor"/>
                </svg>
            `;
            
            // Ken Burns íš¨ê³¼
            const img = document.getElementById('detailImage');
            img.className = `detail-image ken-burns-${currentEffect}`;
            
            // ìë§‰ ì¤€ë¹„
            const words = currentScript.split(' ');
            const subtitleEl = document.getElementById('subtitleText');
            subtitleEl.innerHTML = words.map((word, i) => 
                `<span class="subtitle-word" data-index="${i}">${word}</span>`
            ).join(' ');
            
            // TTS ì‹œì‘
            playTTS(currentScript, words);
        }
        
        // TTS ì¬ìƒ (ë¸Œë¼ìš°ì €)
        function playTTS(text, words) {
            const synth = window.speechSynthesis;
            synth.cancel();
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ko-KR';
            utterance.rate = 0.9;
            
            const voices = synth.getVoices();
            const koreanVoice = voices.find(v => v.lang.includes('ko'));
            if (koreanVoice) utterance.voice = koreanVoice;
            
            // ë‹¨ì–´ í•˜ì´ë¼ì´íŒ…
            let wordIndex = 0;
            const avgDuration = (text.length * 80) / words.length;
            
            const highlightInterval = setInterval(() => {
                if (wordIndex >= words.length || !isPlaying) {
                    clearInterval(highlightInterval);
                    return;
                }
                
                document.querySelectorAll('.subtitle-word').forEach((el, i) => {
                    el.classList.remove('active');
                    if (i < wordIndex) el.classList.add('spoken');
                });
                
                const currentWord = document.querySelector(`[data-index="${wordIndex}"]`);
                if (currentWord) currentWord.classList.add('active');
                
                wordIndex++;
            }, avgDuration);
            
            utterance.onend = () => {
                clearInterval(highlightInterval);
                stopPlay();
            };
            
            synth.speak(utterance);
        }
        
        // ì¬ìƒ ì¤‘ì§€
        function stopPlay() {
            isPlaying = false;
            window.speechSynthesis.cancel();
            
            document.getElementById('playBtn').innerHTML = `
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3" fill="currentColor"/>
                </svg>
            `;
            
            document.getElementById('detailImage').className = 'detail-image';
        }
        
        // ìŒì„± ë¡œë“œ
        window.speechSynthesis.onvoiceschanged = () => {
            console.log('Voices loaded:', window.speechSynthesis.getVoices().length);
        };
    </script>
</body>
</html>
